# FIN schema

## MVP

Минимальная функция:

* начальные остатки
* периодические (еженедельно, ежемесячно) фин операции - выплаты и поступления
* разовые фин операции
* контракты: группы операций
* добавляем аналитические признаки - счёт БДДС, субсчёт, суб-субсчёт, контрагент, контракт, проект 
* детализация временной шкалы: день, неделя
* отображение платежного календаря на текущую неделю с отображением 
  в pivot table - группировка данных внутри платежного календаря с распределением по указанной 
  степени детальности (день, неделя)
* разные планы
* тэги финансовой операции (счета, контракты и тп)
* иерархические тэги
* 

### FinOp: Финансовая операция

* id: идентификатор операции
* isPeriodic: (boolean) периодическая операция
* type:
  * 0: нет данных
  * 1: нач остаток
  * 2: поступление
  * 3: выплата
* planId: идентификатор финансового плана, к которому относится операция (пусто для фактов)
* date: дата операции
* caption: описание
* summ: сумма
* partyId: (-> FinParty.id) наша сторона (юр лицо или компания)
* customerPartyId: (-> FinParty.id) контрагент
* finTags: ([FinTag]) массив тэгов финансовой операции
  (?) план - один из тэгов? факт - один из тэгов?
  
### FinOpPeriodic: периодическая финансовая операция

Дополнение к операции, описывающая периодическую операцию: как именно повторяется периодическая операция. 
Дата в этом случае - начало периода, когда операция начинает повторяться.

* id: ссылка на фин операцию
* period: (weekly / monthly)
* num: 
  * для недели - в какой день недели (от 1 до 7)
  * для месяца: в какой день (1-31, 32 - всегда в последний день месяца)
* dateEnd: конец интервала повторения

(? *на будущее*:
* maxDuration: длительность повторения в днях
* maxDurationIsWD: признак, что длительность указана в рабочих днях
)
  
### FinPlan

* id:
* caption: название фин плана

### FinTag: тэг фин операции

* id
* parent
* caption

### FinAccount

Счёт учёта в финансовой подсистеме

* id: идентификатор
* caption: 
* bddsType: тип счёта для БДДС
  * 0: не известно
  * 1: поступление
  * 2: выплата
  * 3: иное
* party_id: контрагент для ведения счёта 

### FinParty

Контрагент - справочник контрагентов (юридических, физических лиц и тп)

* id: идентификатор контрагента
* caption: название
* type: 
  0: не известно
  1: физическое лицо (Person)
  2: ИП (PersonBiz)
  3: самозанятый (PersonSelfEmp)
  4: юридическое лицо (Company)
  5: банк (Bank)
  (6: брокер, страховая компания, лизинговая) 
  10: иное


### FinBudget: платежный календарь

указываем параметры: какие фин планы включаем в календарь (списком)
какую неделю демонстрируем
материализуем ли тэги





